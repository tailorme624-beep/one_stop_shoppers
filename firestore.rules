rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    match /products/{productId} {
      allow read: if resource.data.status == "active";
      allow write: if false;
    }
    match /orders/{orderId} {
  allow create: if request.auth != null;
  allow read: if request.auth != null
    && request.auth.uid == resource.data.buyerId;
   }
		match /notifications/{notificationId} {
  allow read: if request.auth != null
    && request.auth.uid == resource.data.userId;
	 }
    match /sellers/{sellerId} {
      allow read: if request.auth.uid == sellerId;
    }

    match /product_submissions/{id} {
      allow create: if request.auth != null;
      allow read: if request.auth.uid == resource.data.sellerId;
    }
   
match /notifications/{id} {
  allow read: if request.auth.uid == resource.data.userId;
}


   match /products/{id} {
  allow read: if resource.data.status == "active";
  allow write: if isAdmin();
}

     match /notifications/{id} {
      allow read: if request.auth != null &&
        (
          request.auth.uid == resource.data.userId ||
          get(/databases/$(database)/documents/users/$(request.auth.uid)).data.role == "admin"
        );
        }
        match /orders/{orderId} {
      allow read: if request.auth != null &&
        (
          request.auth.uid == resource.data.buyerId ||
          isAdmin()
        );

      allow update: if isAdmin();
       }

      match /payments/{id} {
  allow read: if request.auth.uid == resource.data.buyerId || isAdmin();
  allow write: if false; // server only
}

  }
}
